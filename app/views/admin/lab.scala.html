
@scripts = {
<style>
      #map-canvas {
       /* height: 100%;*/
        width:500px;
        height:300px;
        margin: 0px;
        padding: 0px
      }
      .controls {
        margin-top: 16px;
        border: 1px solid transparent;
        border-radius: 2px 0 0 2px;
        box-sizing: border-box;
        -moz-box-sizing: border-box;
        height: 32px;
        outline: none;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
      }

      #pac-input {
        background-color: #fff;
        padding: 0 11px 0 13px;
        width: 400px;
        font-family: Roboto;
        font-size: 15px;
        font-weight: 300;
        text-overflow: ellipsis;
        
      }

    .building-name{
        font-family: Roboto;
        border-color: #4d90fe;
        margin-left: -1px;
        padding-left: 14px;  /* Regular padding-left + 1. */
        width: 301px;
    }
        
      #pac-input:focus {
        border-color: #4d90fe;
        margin-left: -1px;
        padding-left: 14px;  /* Regular padding-left + 1. */
        width: 401px;
      }

      .pac-container {
        font-family: Roboto;
        z-index: 10000 !important;
      }

      #type-selector {
        color: #fff;
        background-color: #4d90fe;
        padding: 5px 11px 0px 11px;
      }

      #type-selector label {
        font-family: Roboto;
        font-size: 13px;
        font-weight: 300;
      }


    </style>
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&libraries=places"></script>

    <script type="text/javascript">
      
    $(document).ready(function(){
    
        var markersArray = [];
        
        $('#myMapModal').on('shown.bs.modal', function() {
            resizeShit();
            });
        
        function resizeShit(){  
            var center = map.getCenter();
            google.maps.event.trigger(map, "resize");
            map.setCenter(center); 
            
        }
        
        
        
        
        var ZFM = new google.maps.LatLng(49.782264, 9.974931);
        
        
        /** autocomplete stuff*/
        var mapOptions = {
                
                /** Startwert ist hier das Zentrum für Mediendidaktik (ZFM) der Uni Würzburg*/
                center: new google.maps.LatLng(49.782264, 9.974931),
                zoom: 13
              };
        
        
              var map = new google.maps.Map(document.getElementById('map-canvas'),mapOptions);
              placeMarker(ZFM);
              /** in dem Fall lat + lng =  null!!! */
              

              var input = (document.getElementById('pac-input'));
                
              
              
                /** bindet die autocomplete vorschläge an die Bounds der vorher gesuchten Eingabe!
                
                Wichtig, damit nicht zentren in anderen Städten, sondern immer die die lokal 
                am nächsten sind, zuerst angezeigt werden.
                
                */
              var autocomplete = new google.maps.places.Autocomplete(input);
              autocomplete.bindTo('bounds', map);

              
              
              
              var infowindow = new google.maps.InfoWindow();
              var marker = new google.maps.Marker({
                map: map,
                anchorPoint: new google.maps.Point(0, -29)
              });

              google.maps.event.addListener(autocomplete, 'place_changed', function() {
                infowindow.close();
                marker.setVisible(false);
                var place = autocomplete.getPlace();
                if (!place.geometry) {
                  return;
                }

                // If the place has a geometry, then present it on a map.
                if (place.geometry.viewport) {
                  map.fitBounds(place.geometry.viewport);
                } else {
                  placeMarker(place.geometry.location)  
                  map.setCenter(place.geometry.location);
                  map.setZoom(17);  // Why 17? Because it looks good.
                }
                marker.setIcon(/** */({
                  url: place.icon,
                  size: new google.maps.Size(71, 71),
                  origin: new google.maps.Point(0, 0),
                  anchor: new google.maps.Point(17, 34),
                  scaledSize: new google.maps.Size(35, 35)
                }));
                marker.setPosition(place.geometry.location);
                
                /** wenn der Admin vergisst einen genaueren Marker einzugeben,
                wird immer die adresse genommen, die er eingetippt hat*/
                document.getElementById("latFld").value = place.geometry.location.lat();
                document.getElementById("lngFld").value = place.geometry.location.lng();

              
                marker.setVisible(true);

                var address = '';
                if (place.address_components) {
                  address = [
                    (place.address_components[0] && place.address_components[0].short_name || ''),
                    (place.address_components[1] && place.address_components[1].short_name || ''),
                    (place.address_components[2] && place.address_components[2].short_name || '')
                  ].join(' ');
                }

                infowindow.setContent('<div><strong>' + place.name + '</strong><br>' + address);
                infowindow.open(map, marker);
              });
 
             
        
              
              
            // add a click event handler to the map object
                google.maps.event.addListener(map, "click", function(event)
                {
                    // place a marker
                    placeMarker(event.latLng);

                    // display the lat/lng in your form's lat/lng fields
                    document.getElementById("latFld").value = event.latLng.lat();
                    document.getElementById("lngFld").value = event.latLng.lng();
                });
                
                function placeMarker(location) {
                    // first remove all markers if there are any
                    deleteOverlays();

                    var marker = new google.maps.Marker({
                        position: location, 
                        map: map
                    });

                    // add marker in markers array
                    markersArray.push(marker);

                    //map.setCenter(location);
                }

                // Deletes all markers in the array by removing references to them
                function deleteOverlays() {
                    if (markersArray) {
                        for (i in markersArray) {
                            markersArray[i].setMap(null);
                        }
                    markersArray.length = 0;
                    }
                }
  
    });  
    </script>

    

}



@main(null,scripts, "admin") {



<div class="page-header">
<h3>Labore <span class="label label-default">16</span>      
            <button data-toggle="modal" data-target="#myMapModal" class="btn btn-default loc pull-right" title="Juliuspromenade 8, 97070 WÃ¼rzburg"><span class="glyphicon glyphicon-plus"></span>Neues Gebäude</button>
        </h3>    </div>
	

	
			<div class="row myStudies_ListView">
			<div class="col-sm-9 col-xs-6"><h4>GameBox</h4></div>
				
			<div class="col-sm-3 col-xs-6">
			<button class="btn btn-default btn" id="add" data-toggle="modal" data-target="#myMapModal"><span class="glyphicon glyphicon-map-marker"></span> Standort bearbeiten</button>
			</div>
			
			</div>
			
			<hr>
			
			
			<div class="row">
			<div class="col-sm-3 col-xs-6"><b>Raum 00.205</b></div>
			<div class="col-sm-3 col-xs-6">	<button class="btn btn-default btn-sm" id="add" data-toggle="modal" data-target="#myRoomModal"><span class="glyphicon glyphicon-pencil"></span> Standort Beschreiben</button></div>
			<div class="col-sm-3 col-xs-6">	<button class="btn btn-danger btn-sm"><span class="glyphicon glyphicon-remove"></span> </button></div> 
			</div>
		
		<hr>
			<div class="row">
			<div class="col-sm-3 col-xs-6 col-sm-offset-2"><b>Raum 00.206</b></div>
			<div class="col-sm-3 col-xs-6">	<button class="btn btn-default btn-sm" id="add" data-toggle="modal" data-target="#myRoomModal"><span class="glyphicon glyphicon-pencil"></span> Standort Beschreiben</button></div>
			<div class="col-sm-3 col-xs-6">	<button class="btn btn-danger btn-sm"><span class="glyphicon glyphicon-remove"></span> </button></div> 
			</div>
		
		<hr>
			<div class="row">
			<div class="col-sm-3 col-xs-6 col-sm-offset-2"><b>Raum 00.207</b></div>
			<div class="col-sm-3 col-xs-6">	<button class="btn btn-default btn-sm" id="add" data-toggle="modal" data-target="#myRoomModal"><span class="glyphicon glyphicon-pencil"></span> Standort Beschreiben</button></div>
			<div class="col-sm-3 col-xs-6">	<button class="btn btn-danger btn-sm"><span class="glyphicon glyphicon-remove"></span> </button></div> 
			</div>
		
		<hr>
			<div class="row">
			<div class="col-sm-3 col-xs-6 col-sm-offset-2"><b>Raum 00.208</b></div>
			<div class="col-sm-3 col-xs-6">	<button class="btn btn-default btn-sm" id="add" data-toggle="modal" data-target="#myRoomModal"><span class="glyphicon glyphicon-pencil"></span> Standort Beschreiben</button></div>
			<div class="col-sm-3 col-xs-6">	<button class="btn btn-danger btn-sm"><span class="glyphicon glyphicon-remove"></span> </button></div> 
			</div>
		
		<hr>
			<div class="row">
			<div class="col-sm-3 col-xs-6 col-sm-offset-2"><b>Raum 00.209</b></div>
			<div class="col-sm-3 col-xs-6">	<button class="btn btn-default btn-sm" id="add" data-toggle="modal" data-target="#myRoomModal"><span class="glyphicon glyphicon-pencil"></span> Standort Beschreiben</button></div>
			<div class="col-sm-3 col-xs-6">	<button class="btn btn-danger btn-sm"><span class="glyphicon glyphicon-remove"></span> </button></div> 
			</div>
		
		<hr>
			<div class="row">
			<div class="col-sm-3 col-xs-6 col-sm-offset-2"><b>Raum 00.210</b></div>
			<div class="col-sm-3 col-xs-6">	<button class="btn btn-default btn-sm" id="add" data-toggle="modal" data-target="#myRoomModal"><span class="glyphicon glyphicon-pencil"></span> Standort Beschreiben</button></div>
			<div class="col-sm-3 col-xs-6">	<button class="btn btn-danger btn-sm"><span class="glyphicon glyphicon-remove"></span> </button></div> 
			</div>
		
		<hr>
			<div class="row">
			<div class="col-sm-3 col-xs-6 col-sm-offset-2"><b>Raum 00.305</b></div>
			<div class="col-sm-3 col-xs-6">	<button class="btn btn-default btn-sm" id="add" data-toggle="modal" data-target="#myRoomModal"><span class="glyphicon glyphicon-pencil"></span> Standort Beschreiben</button></div>
			<div class="col-sm-3 col-xs-6">	<button class="btn btn-danger btn-sm"><span class="glyphicon glyphicon-remove"></span> </button></div> 
			</div>
		
		<hr>
			<div class="row">
			<div class="col-sm-3 col-xs-6 col-sm-offset-2"><b>Raum 00.308</b></div>
			<div class="col-sm-3 col-xs-6">	<button class="btn btn-default btn-sm" id="add" data-toggle="modal" data-target="#myRoomModal"><span class="glyphicon glyphicon-pencil"></span> Standort Beschreiben</button></div>
			<div class="col-sm-3 col-xs-6">	<button class="btn btn-danger btn-sm"><span class="glyphicon glyphicon-remove"></span> </button></div> 
			</div>
		
		<hr>
		
</div>
<!-- Ende container -->


<!-- Beginn Map-Modal -->
<div class="modal fade" id="myMapModal">
    <div class="modal-dialog admin_map1">
        <div class="modal-content contains_map2">
            <div class="modal-header">
            	Laborbezeichnung
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>
                 </div>
                 <div class="row">
            					<div class="col-sm-3">
            						<input class="form-control" type="text" placeholder="z.B. GameBox"/>
            					</div>
            
            			</div>  

					<div class="row">
            					<div class="col-sm-3">
            					<b>Location</b>
            						<input id="pac-input" class="form-control" type="text"
						        placeholder="z.B. Zentrum für Mediendidaktik"/>
            					</div>
            
            			</div> 
            			
            					<b>Setzen Sie einen Marker auf der Karte.</b>
            
            			</div>  

            </div>
  
   <div class="modal-body contains_map3">
                <div class="container contains_map4">
                    <div class="row contains_map4">
                                 
						 
						    <div id="map-canvas"></div>
     					
                    </div>
                </div>
            </div>
            <div class="modal-footer" style="height:5%;">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal">Save changes</button>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
    </div>
    <!-- /.modal -->
    
    
    
    
    
    <!-- Raumbeschreibungs-modal -->
    <div class="modal fade" id="myRoomModal">
    <div class="modal-dialog admin_map1">
        <div class="modal-content contains_map2">
            <div class="modal-header">
            	
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>
                 
                 <div class="row">
            					<div class="col-sm-3">
            					<b>Raum</b>
            						<input class="controls building-name" type="text"
            					
						        placeholder="z.B. Raum 00.105"/>
            					</div>
            
            			</div>  

					<div class="row">
            					<div class="col-sm-3">
            					<b>Location</b>
            						<textarea class="field span12 desc-padding" id="textarea" cols="55" rows="15" placeholder="z.B. Der Raum 00.1XX befindet sich im oberen Stockwerk."></textarea>
						        	
            					</div>
            
            			</div> 
            			
            		<div class="row">
            					<div class="col-sm-12">
            					<i>Diese Beschreibung wird den Studenten als MarkerText auf der Karte angezeigt </i>
            					</div>
            
            			</div>  

            </div>
  
   <div class="modal-body contains_map3">
                <div class="container contains_map4">
                    <div class="row contains_map4">
                                 
						 
						    <div id="map-canvas"></div>
     					
                    </div>
                </div>
            </div>
            <div class="modal-footer" style="height:5%;">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal">Save changes</button>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
    </div>
    <!-- /.modal -->



}